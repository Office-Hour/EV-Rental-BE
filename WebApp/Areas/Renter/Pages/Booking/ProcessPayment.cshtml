@page
@model WebApp.Areas.Renter.Pages.Booking.ProcessPaymentModel
@{
    ViewData["Title"] = "Đang Xử Lý Thanh Toán";
}

<link rel="stylesheet" href="~/css/Index.css" />
<link rel="stylesheet" href="~/css/identity.css" asp-append-version="true" />

<section class="payment-processing-section">
    <div class="container" style="max-width: 600px;">
        @if (string.IsNullOrEmpty(Model.ErrorMessage))
        {
            <!-- Processing State -->
            <div class="processing-card">
                <div class="spinner-container">
                    <div class="spinner"></div>
                </div>
                <h2>Đang chuyển đến cổng thanh toán...</h2>
                <p class="text-muted">Vui lòng không đóng trang này.</p>
                
                <div class="payment-info">
                    <div class="info-row">
                        <span class="label">Mã đặt chỗ:</span>
                        <span class="value">@Model.BookingId.ToString().Substring(0, 8).ToUpper()</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Số tiền:</span>
                        <span class="value">@Model.Amount.ToString("N0") VNĐ</span>
                    </div>
                </div>
            </div>
        }
        else
        {
            <!-- Error State -->
            <div class="error-card">
                <span class="material-icons error-icon">error</span>
                <h2>Lỗi Thanh Toán</h2>
                <p class="error-message">@Model.ErrorMessage</p>
                
                <div class="button-group">
                    <a asp-page="./ProcessPayment" 
                       asp-route-bookingId="@Model.BookingId"
                       asp-route-amount="@Model.Amount"
                       asp-route-description="@Model.Description"
                       class="btn btn-primary">
                        <span class="material-icons">refresh</span>
                        Thử Lại
                    </a>
                    <a asp-page="/RenterProfile" asp-area="Renter" class="btn btn-secondary">
                        <span class="material-icons">arrow_back</span>
                        Quay Về
                    </a>
                </div>
            </div>
        }
    </div>
</section>

<style>
    .payment-processing-section {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 2rem 0;
    }

    .processing-card, .error-card {
        background: white;
        border-radius: 16px;
        padding: 3rem 2rem;
        text-align: center;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }

    .spinner-container {
        margin-bottom: 2rem;
    }

    .spinner {
        width: 60px;
        height: 60px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto;
    }

    @@keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .processing-card h2 {
        font-size: 1.5rem;
        color: #333;
        margin-bottom: 0.5rem;
    }

    .payment-info {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 1.5rem;
        margin-top: 2rem;
    }

    .info-row {
        display: flex;
        justify-content: space-between;
        padding: 0.5rem 0;
    }

    .info-row .label {
        color: #666;
        font-weight: 500;
    }

    .info-row .value {
        color: #333;
        font-weight: 600;
    }

    .error-icon {
        font-size: 64px;
        color: #dc3545;
        margin-bottom: 1rem;
    }

    .error-card h2 {
        color: #dc3545;
        margin-bottom: 1rem;
    }

    .error-message {
        color: #666;
        margin-bottom: 2rem;
    }

    .button-group {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
    }

    .btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-weight: 500;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .btn-primary {
        background: #667eea;
        color: white;
    }

    .btn-primary:hover {
        background: #5568d3;
    }

    .btn-secondary {
        background: #6c757d;
        color: white;
    }

    .btn-secondary:hover {
        background: #5a6268;
    }
</style>
